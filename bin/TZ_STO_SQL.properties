#####################################################################################################################
#																													#
#---------------------------------------sql\u812b\u8302\u622e\u76f2\u9732\u7bd3\u812a\u6c13\u9e7f\u5fd9\u812d\u8c8c---------------------------------------------------------------#
# * \u8120\u9686\u864f\u8123\u788c\u697c\u5364\u813f\u6f5e\u811c\u811f\u63b3\u8120\u5a92\u8126\u7984+5\u8126\u7984\u8123\u9c81\u8128\u8c8c\u6f5e\u811c																		#
# * \u810c\u5a92\u8120\u83bd\u62e2\u6f5e\u8122\u812e\u8def\u8129\u9e7f\u813a\u810c\u94c6chg01_000 chg--\u8122\u812e\u8def\u8129\u8128\u811c\u8127\u5784\u811b\u62e2\u9a74\u8305  01--\u811d\u812e\u8125\u7bd3\u8121\u8124\u811d\u8def\u8122\u812e\u8def\u8129\u9e7f\u813a\u810c\u94c6  000--\u788c\u5364\u811f\u63b3\u9a74\u964b\u8def\u5784\u8122\u9e7f\u812b\u8119sql\u8123\u9c81\u8128\u8c8c\u6f5e\u811c				#
# *       \u8122\u812e\u8def\u8129\u9e7f\u813a\u810c\u94c6chg02_000 chg--\u8122\u812e\u8def\u8129\u8128\u811c\u8127\u5784\u811b\u62e2\u9a74\u8305  02--\u9732\u7bd3\u8130\u811d\u8121\u8124\u811d\u8def\u8122\u812e\u8def\u8129\u9e7f\u813a\u810c\u94c6  000--\u788c\u5364\u811f\u63b3\u9a74\u964b\u8def\u5784\u8122\u9e7f\u812b\u8119sql\u8123\u9c81\u8128\u8c8c\u6f5e\u811c				#
# *       \u8122\u812e\u8def\u8129\u9e7f\u813a\u810c\u94c6chg03_000 chg--\u8122\u812e\u8def\u8129\u8128\u811c\u8127\u5784\u811b\u62e2\u9a74\u8305  03--\u8126\u5362\u8128\u813c\u8121\u8124\u811d\u8def\u8122\u812e\u8def\u8129\u9e7f\u813a\u810c\u94c6  000--\u788c\u5364\u811f\u63b3\u9a74\u964b\u8def\u5784\u8122\u9e7f\u812b\u8119sql\u8123\u9c81\u8128\u8c8c\u6f5e\u811c				#
# * \u622e\u813d\u8124\u6c13\u5364\u813f\u8128\u9e93\u8d42\u5e3d\u8122\u9646\u622e\u8135\u810c\u5a92\u62e2\u6f5e																			#
# * #\u788c\u697c\u8126\u7984\u9e7f\u813a\u810c\u94c6#																					#
# * bas01_000=select * from ab01 where aab001=:aab001 and aab004=:aab004						#
# * bas02_002=select * from ab01 where aab002=:aab002 and aab003=:aab003						#
# * 																							#
# * #\u8120\u8123\u812d\u5364\u9e7f\u813a\u810c\u94c6#																					#
# * bas02_000=select * from ac01 where aab001=:aab001 and aab004=:aab004						#
# * bas02_001=select * from ac01 where aab002=:aab002 and aab003=:aab003						#
# * 																							#
######################################################################################################################

#\u9a74\u8292\u9e93\u5fd9\u9e7f\u813a\u810c\u94c6#


sto01_000=select * from tblsto s where s.stoproid=:stoproid! 
sto01_001=insert into tblsto(stoid, stogrcliid, stoproid, stoprotype, stoproname, stoamountun,stoamount,  stoproprice, stoindate, stooutdate,stoactype, storemark, stooprcd,stodisc,stodate,stopid) values(SEQ_STOID.Nextval, :stogrcliid!, :stoproid!, :stoprotype!, :stoproname!,:stoamountun!, :stoamount!,  :stoproprice!, :stoindate!, :stooutdate!, :stoactype!, :storemark!, :stooprcd!,:stodisc!,:stodate!,:stopid!)

#sto02_000=update tblsto set stoproamount=:stoproamount!,stodate=:stodate!,stoactype=:stoactype! where stogrpcliid=:stogrpcliid!
sto02_000=insert into tblsto (stoid, stogrcliid, stoproid, stoprotype, stoproname, stoamountun, stoamount, stoactype, storemark, stooprcd, stodate) values (:stoid!, :stogrcliid!, :stoproid!, :stoprotype!, :stoproname!, :stoamountun!, :stoamount!, :stoactype!, :storemark!, :stooprcd!, :stodate!)
sto02_001=select (case when s.aab300='\u60e0\u8033\u542c\u529b\u603b\u90e8' then s.aab300 else t.gctnm end) as gctnm, o.stoproid,o.stoproname, o.stoproprice,o.stoamount,o.stoamountun,o.stoactype, o.stodate, o.stodisc,o.storemark  from tblsto o left join sc01 s on o.stogrcliid=s.bsc001  left join tblgrpclient t on t.gctid=o.stogrcliid where gctnm like :gctnm! and stoproid like :stoproid! and stoproname like :stoproname!  and s.stodisc=:stodisc!  and stodate>=:start! and stodate<=:end! 
sto02_001=select t.gctnm,o.stogrcliid,o.stoproid,o.stoproname,o.stoproprice,o.stoamount,o.stoamountun,o.stoactype, o.stodate, o.stodisc,o.storemark from tblsto o left join tblgrpclient t on t.gctid=o.stogrcliid where gctnm like :gctnm! and stoproid like :stoproid! and stoproname like :stoproname!  and o.stodisc=:stodisc! and stodate>=:start! and stodate<=:end!     

sto03_001=update tblsto set stodisc=:stodisc! where stoid=:stoid!

sto03_002=update tblsto set stoamount=stoamount-1 where stoid=:stoid!

sto03_003=select t.fdtfno,(case when s.aab300='\u60e0\u8033\u542c\u529b\u603b\u90e8' then s.aab300 else l.gctnm end)as folctnm,p.pdtnm,t.fdtqnt,t.fdtprc,f.foldt,f.folsta,o.bsc012 as foloprnm,t.fdtnt from tblfolio f left join tblfoldetail t on f.folno=t.fdtfno left join tblgrpclient l on f.folctid=l.gctid left join  sc01 s on f.folctid=s.bsc001  left join tblproduct p on t.fdtpid=p.pdtid   left join  SC05 o on o.bsc011=f.folopr  where f.folno=:folno!

sto04_001=select distinct s.stoid,s.stogrcliid,s.isrepair,s.stoproid,s.stoproname, s.stoamount, s.stoamountun, s.stoproprice, s.stodate, s.stooutdate, s.stoactype, s.storemark,(case when s.stogrcliid='1501000000' then '\u60e0\u8033\u542c\u529b\u603b\u90e8' else t.gctnm end)as gctnm,s.stodisc,NVL2(c.pcllarge,c.pcllarge||'-'||c.pclmid||'-'||c.pclsmall,'') as stoprotype,p.pdtprc,p.pdtut from tblsto s left join tblgrpclient t on t.gctid=s.stogrcliid left join tblproclass c on s.stoprotype=c.pclid  left join tblproduct p on s.stoproid=p.pdtid where  s.stogrcliid=:stogrcliid! and stoproid like :stoproid! and stoproname like :stoproname!  and s.stodisc=:stodisc! and s.stoactype=:stoactype! and s.stodate>=:start! and s.stodate<=:end! and s.isrepair=:isrepair!
sto04_001_his=select distinct s.stoid,s.stogrcliid,s.isrepair,s.stoproid,s.stoproname, s.stoamount, s.stoamountun, s.stoproprice, s.stodate, s.stooutdate, s.stoactype, s.storemark,(case when s.stogrcliid='1501000000' then '\u60e0\u8033\u542c\u529b\u603b\u90e8' else t.gctnm end)as gctnm,s.stodisc,NVL2(c.pcllarge,c.pcllarge||'-'||c.pclmid||'-'||c.pclsmall,'') as stoprotype,p.pdtprc,p.pdtut from tblsto@mylinke s left join tblgrpclient t on t.gctid=s.stogrcliid left join tblproclass c on s.stoprotype=c.pclid  left join tblproduct p on s.stoproid=p.pdtid where  s.stogrcliid=:stogrcliid! and stoproid like :stoproid! and stoproname like :stoproname!  and s.stodisc=:stodisc! and s.stoactype=:stoactype! and s.stodate>=:start! and s.stodate<=:end! and s.isrepair=:isrepair!

#sto04_001=select t.gctnm,s.stoid,s.stogrcliid, s.stoproid,s.stoproname, s.stoamount, s.stoamountun, s.stoproprice, s.stodate, s.stooutdate,s.stoactype, s.storemark,s.stodisc,NVL2(c.pcllarge,c.pcllarge||'-'||c.pclmid||'-'||c.pclsmall,'') as stoprotype,p.pdtprc,p.pdtut from tblsto s left join tblgrpclient t on t.gctid=s.stogrcliid  left join tblproclass c on s.stoprotype=c.pclid  left join tblproduct p on s.stoproid=p.pdtid where t.gctnm like :gctnm! and s.stoproid=:stoproid! and s.stoproname like :stoproname!  and s.stodisc=:stodisc! and s.stoactype=:stoactype! and s.stodate>=:start! and s.stodate<=:end!
#sto04_002=select (case when s.stogrcliid='1501000000' then '\u60e0\u8033\u542c\u529b\u603b\u90e8' else t.gctnm end)as gctnm,s.stoid,s.stogrcliid, s.stoproid,s.stoproname, s.stoamount, s.stoamountun, s.stoproprice, s.stodate, s.stooutdate,s.stoactype, s.storemark,s.stodisc,NVL2(c.pcllarge,c.pcllarge||'-'||c.pclmid||'-'||c.pclsmall,'') as stoprotype,p.pdtprc,p.pdtut from tblsto s left join tblgrpclient t on t.gctid=s.stogrcliid  left join tblproclass c on s.stoprotype=c.pclid  left join tblproduct p on s.stoproid=p.pdtid where s.stogrcliid=:stogrcliid! and s.stoproid=:stoproid! and s.stoproname =:stoproname!
sto04_002=select t.gctnm,s.stoid,s.stogrcliid, s.isrepair,s.stoproid,s.stoproname, s.stoamount, s.stoamountun, s.stoproprice, s.stodate, s.stooutdate,s.stoactype, s.storemark,s.stodisc,NVL2(c.pcllarge,c.pcllarge||'-'||c.pclmid||'-'||c.pclsmall,'') as stoprotype,p.pdtprc,p.pdtut from tblsto s left join tblgrpclient t on t.gctid=s.stogrcliid  left join tblproclass c on s.stoprotype=c.pclid  left join tblproduct p on s.stoproid=p.pdtid where t.gctnm =:gctnm! and s.stoproid=:stoproid! and s.stoproname =:stoproname! and s.isrepair=:isrepair!
sto04_003=select t.gctnm,s.stoid,s.stogrcliid, s.isrepair,s.stoproid,s.stoproname, s.stoamount, s.stoamountun, s.stoproprice, s.stodate, s.stooutdate,s.stoactype, s.storemark,s.stodisc,NVL2(c.pcllarge,c.pcllarge||'-'||c.pclmid||'-'||c.pclsmall,'') as stoprotype,p.pdtprc,p.pdtut from tblsto s left join tblgrpclient t on t.gctid=s.stogrcliid  left join tblproclass c on s.stoprotype=c.pclid  left join tblproduct p on s.stoproid=p.pdtid where t.gctnm =:gctnm! and s.stoproid=:stoproid! and s.stoproname =:stoproname! and stodate>=:start! and stodate<=:end! and stoactype=:stoactype!


sto05_001=select distinct s.isrepair,g.gctnm, s.stocllar,sum(s.stoamount*s.stoactype)over (partition by s.stocllar,stogrcliid,s.isrepair) as laramount,s.stoclmid,sum(s.stoamount*s.stoactype)over(partition by s.stoclmid,stogrcliid,s.isrepair) as midamount,s.stoclsam,sum(s.stoamount*s.stoactype)over(partition by s.stoclsam,stogrcliid,s.isrepair) as samamount,s.stoproname,s.stoproid,sum(s.stoamount*s.stoactype)over(partition by s.stoproid,s.stogrcliid,s.stoproname,s.isrepair) as amount from tblsto s left join tblgrpclient g on g.gctid=s.stogrcliid where g.gctnm like:gctnm! and s.stocllar=:stocllar! and s.stoclmid=:stoclmid! and s.stoclsam=:stoclsam! and s.stoproname like:stoproname! and s.stoproid like:stoproid! and s.isrepair=:isrepair!

sto06_000=select * from tblsto where stoid=:stoid!

sto_panku=insert into tblsto select seq_stoid.nextval, stogrcliid, stoproid, stoprotype, stoproname, abs(amount), stoamountun, stoproprice, stoindate, stooutdate, stoactype, storemark, stooprcd, stodisc, trunc(sysdate- interval '1' YEAR,'yyyy'), stopid, stoprodsc, stocllar, stoclmid, stoclsam, isrepair from ( select distinct s.stogrcliid as stogrcliid, s.stoproid as stoproid, null as stoprotype, s.stoproname as stoproname, sum(s.stoamount*s.stoactype)over(partition by s.stoproid,s.stogrcliid,s.stoproname,s.isrepair,s.stocllar,s.stoclmid,s.stoclsam) as amount, '1' as stoamountun, '0' as stoproprice, null as stoindate, null as stooutdate, (case  when sum(s.stoamount*s.stoactype)over(partition by s.stoproid,s.stogrcliid,s.stoproname,s.isrepair,s.stocllar,s.stoclmid,s.stoclsam)>=0 then '1' else '-1' end) as stoactype, '\u76D8\u5E93' as storemark, null as stooprcd, '0' as stodisc, to_date('2015-08-17','yyyy-mm-dd') as stodate, null as stopid, null as stoprodsc, s.stocllar as stocllar, s.stoclmid as stoclmid, s.stoclsam as stoclsam, s.isrepair as isrepair from tblsto s left outer join tblgrpclient c on s.stogrcliid=c.gctid where c.gctnm=:gctnm! and s.stodate <trunc(sysdate- interval '1' year,'yyyy'))
sto_panku1=insert into tblsto@mylinke select seq_stoid.nextval@mylinke, stogrcliid, stoproid, stoprotype, stoproname, stoamount, stoamountun, stoproprice, stoindate, stooutdate, stoactype, storemark, stooprcd, stodisc, stodate, stopid, stoprodsc, stocllar, stoclmid, stoclsam, isrepair from tblsto s left outer join tblgrpclient c on s.stogrcliid=c.gctid where c.gctnm =:gctnm! and stodate <trunc(sysdate- interval '1' year,'yyyy') 
sto_panku2=delete from tblsto where stogrcliid in ( select distinct gctid from tblgrpclient where gctnm =:gctnm!) and stodate <trunc(sysdate- interval '1' year,'yyyy') 

