#####################################################################################################################
#																													#
#---------------------------------------sql语句定义规则---------------------------------------------------------------#
# * 取菜单编号前三位+5位顺序号																		#
# * 例如：基本信息 单位管理 bas01_000 bas--基础信息模块 01--单位管理  000--当前开发使用sql顺序号				#
# *      基本信息 人员管理 bas02_000 bas--基础信息模块 02--人员管理  000--当前开发使用sql顺序号				#
# *      基本信息 人员管理 bas02_000 bas--基础信息模块 02--人员管理  000--当前开发使用sql顺序号				#
# * 具体编写格式举例：																			#
# * #单位管理#																					#
# * bas01_000=select * from ab01 where aab001=:aab001 and aab004=:aab004						#
# * bas02_002=select * from ab01 where aab002=:aab002 and aab003=:aab003						#
# * 																							#
# * #人员管理#																					#
# * bas02_000=select * from ac01 where aab001=:aab001 and aab004=:aab004						#
# * bas02_001=select * from ac01 where aab002=:aab002 and aab003=:aab003						#
# * 																							#
######################################################################################################################
#定制机管理#

clt01_000=select distinct t.*,m.tmksid as ictsid,g.gctnm,b.bvassess from tblindclient t left outer join tblmaking m on t.ictid = m.tmkcltid left join tblgrpclient g on g.gctid=t.ictgctid left join tblbv b on b.bvno=m.tmkcltid and (b.bvrightnum=m.tmksid or b.bvleftnum=m.tmksid) where 1=1 and t.ictnm like:ictnm! and g.gctnm like:gctnm! and t.ictgctid=:ictgctid! and m.tmksid like:ictsid! and t.ictaddr like:ictaddr! and b.bvassess=:bvassess!
clt02_000=select * from tblgrpclient where gctid like:gctid! and gctnm=:gctnm!
clt02_001=select * from tblgrpclient where gctid like:gctid! and gctnm like:gctnm! and gcttype like:gcttype!

##clt03_000=select sum(case when adglre='L' and adgtp='G' and adgfq=250 then adgadt else null end) as lg250,sum(case when adglre='L' and adgtp='G' and adgfq=500 then adgadt else null end) as lg500,sum(case when adglre='L' and adgtp='G' and adgfq=1000 then adgadt else null end) as lg1000,sum(case when adglre='L' and adgtp='G' and adgfq=2000 then adgadt else null end) as lg2000,sum(case when adglre='L' and adgtp='G' and adgfq=4000 then adgadt else null end) as lg4000,round(avg(case when adglre='L' and adgtp='G' and adgfq in ('500','1000','2000') then adgadt else null end),2) as lgavg,sum(case when adglre='L' and adgtp='Q' and adgfq=250 then adgadt else null end) as lq250,sum(case when adglre='L' and adgtp='Q' and adgfq=500 then adgadt else null end) as lq500,sum(case when adglre='L' and adgtp='Q' and adgfq=1000 then adgadt else null end) as lq1000,sum(case when adglre='L' and adgtp='Q' and adgfq=2000 then adgadt else null end) as lq2000,sum(case when adglre='L' and adgtp='Q' and adgfq=4000 then adgadt else null end) as lq4000,round(avg(case when adglre='L' and adgtp='Q' and adgfq in ('500','1000','2000') then adgadt else null end),2) as lqavg,sum(case when adglre='R' and adgtp='G' and adgfq=250 then adgadt else null end) as rg250,sum(case when adglre='R' and adgtp='G' and adgfq=500 then adgadt else null end) as rg500,sum(case when adglre='R' and adgtp='G' and adgfq=1000 then adgadt else null end) as rg1000,sum(case when adglre='R' and adgtp='G' and adgfq=2000 then adgadt else null end) as rg2000,sum(case when adglre='R' and adgtp='G' and adgfq=4000 then adgadt else null end) as rg4000,round(avg(case when adglre='R' and adgtp='G' and adgfq in ('500','1000','2000') then adgadt else null end),2) as rgavg,sum(case when adglre='R' and adgtp='Q' and adgfq=250 then adgadt else null end) as rq250,sum(case when adglre='R' and adgtp='Q' and adgfq=500 then adgadt else null end) as rq500,sum(case when adglre='R' and adgtp='Q' and adgfq=1000 then adgadt else null end) as rq1000,sum(case when adglre='R' and adgtp='Q' and adgfq=2000 then adgadt else null end) as rq2000,sum(case when adglre='R' and adgtp='Q' and adgfq=4000 then adgadt else null end) as rq4000,round(avg(case when adglre='R' and adgtp='Q' and adgfq in ('500','1000','2000') then adgadt else null end),2) as rqavg from tblaudgraph where adgctid=:ictid!
clt03_000=select sum(  case when adglre='L' and adgtp ='G' and adgfq =250 then adgadt else null  end) as lg250,  sum(  case when adglre='L' and adgtp ='G' and adgfq =500 then adgadt else null  end) as lg500,  sum(  case when adglre='L' and adgtp ='G' and adgfq =750 then adgadt else null  end) as lg750,  sum(  case when adglre='L' and adgtp ='G' and adgfq =1000 then adgadt else null  end) as lg1000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =1500 then adgadt else null  end) as lg1500,  sum(  case when adglre='L' and adgtp ='G' and adgfq =2000 then adgadt else null  end) as lg2000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =3000 then adgadt else null  end) as lg3000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =4000 then adgadt else null  end) as lg4000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =6000 then adgadt else null  end) as lg6000,  round(avg(  case when adglre='L' and adgtp ='G' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as lgavg,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =250 then adgadt else null  end) as lq250,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =500 then adgadt else null  end) as lq500,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =750 then adgadt else null  end) as lq750,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =1000 then adgadt else null  end) as lq1000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =1500 then adgadt else null  end) as lq1500,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =2000 then adgadt else null  end) as lq2000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =3000 then adgadt else null  end) as lq3000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =4000 then adgadt else null  end) as lq4000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =6000 then adgadt else null  end) as lq6000,  round(avg(  case when adglre='L' and adgtp ='Q' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as lqavg,  sum(  case when adglre='R' and adgtp ='G' and adgfq =250 then adgadt else null  end) as rg250,  sum(  case when adglre='R' and adgtp ='G' and adgfq =500 then adgadt else null  end) as rg500,  sum(  case when adglre='R' and adgtp ='G' and adgfq =750 then adgadt else null  end) as rg750,  sum(  case when adglre='R' and adgtp ='G' and adgfq =1000 then adgadt else null  end) as rg1000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =1500 then adgadt else null  end) as rg1500,  sum(  case when adglre='R' and adgtp ='G' and adgfq =2000 then adgadt else null  end) as rg2000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =3000 then adgadt else null  end) as rg3000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =4000 then adgadt else null  end) as rg4000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =6000 then adgadt else null  end) as rg6000,  round(avg(  case when adglre='R' and adgtp ='G' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as rgavg,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =250 then adgadt else null  end) as rq250,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =500 then adgadt else null  end) as rq500,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =750 then adgadt else null  end) as rq750,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =1000 then adgadt else null  end) as rq1000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =1500 then adgadt else null  end) as rq1500,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =2000 then adgadt else null  end) as rq2000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =3000 then adgadt else null  end) as rq3000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =4000 then adgadt else null  end) as rq4000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =6000 then adgadt else null  end) as rq6000,  round(avg(  case when adglre='R' and adgtp ='Q' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as rqavg from tblaudgraph where adgctid=:ictid! 
#clt04_000=select bsc011,bsc012 from sc05
clt04_000=select bsc011,bsc012,bsc010 from sc05
clt04_001=select gctid,gctnm from tblgrpclient where gctvalid='1'
clt04_002=select g.gctid,g.gctnm from tblgrpclient g where g.gcttype <> 'A' 
clt04_003=select g.gctid,g.gctnm from sc05 s left join tblgrpclient g on s.bsc011=g.gctid where s.bsc011=:bsc011!
clt04_004=select bsc008,bsc009 from sc04 
#定制机个人客户查询
clt05_000=select t.*,m.tmksid as repid,g.gctnm from tblindclient t left outer join tblgrpclient g on g.gctid=t.ictgctid left outer join tblmaking m on t.ictid=tmkcltid where t.ictgctid=:ictgctid! and t.ictnm like:ictnm! and t.ictgender=:ictgender! and t.ictaddr like:ictaddr! and m.tmksid like:repid! and g.gctnm=:gctnm!

clt05_001=select distinct t.*,g.gctnm from tblindclient t left outer join tblgrpclient g on g.gctid=t.ictgctid where t.ictgctid=:ictgctid! and t.ictnm like:ictnm! and t.ictgender=:ictgender! and t.ictaddr like:ictaddr! and g.gctnm=:gctnm!

clt05_002=select t.*,l.fdtsid,l.fdtpid as tmepid,g.gctnm from tblindclient t left outer join tblgrpclient g on g.gctid=t.ictgctid left outer join tblfoldetail l on t.ictid=l.fdtcltid where t.ictgctid=:ictgctid! and t.ictnm like:ictnm! and t.ictgender=:ictgender! and t.ictaddr like:ictaddr! and l.fdtsid like:ictsid! and g.gctnm=:gctnm! 
yuyue01_000=select distinct r.* from tblreservation r where r.rsvnm like:rsvnm! and r.rsvdate>=:start! and r.rsvdate<=:end! and r.rsvsta=:rsvsta! and r.rsvsta<>'menzhened' and r.rsvgctnm=:rsvgctnm! and r.rsvgctzhuannm=:rsvgctzhuannm! and r.ypnm=:ypnm!

yuyue01_001=select distinct r.* ,g.gctnm from tblreservation r left outer join tblgrpclient g on g.gctid=r.rsvgcltid where r.rsvnm like:rsvnm! and r.rsvphone=:rsvphone! and r.rsvsta='reservated' and r.rsvgcltid=:rsvgcltid!

yuyue02_000=select r.rsvnm as ictnm,r.rsvphone as icttel,r.rsvgcltid as ictgctid from tblreservation r where r.rsvid=:rsvid!

yuyue03_000=select distinct rsvgctnm,ypnm,count(decode(rsvsta,'reservated','1')) over(partition by rsvgctnm,ypnm) as qdmount,rsvmount,totalmount from (select  rsvgctnm,ypnm,rsvsta,rsvdate, count(*)over(partition by rsvgctnm,ypnm) as rsvmount,count(*)over(partition by rsvgctnm) as totalmount from tblreservation r)where rsvgctnm=:rsvgctnm! and ypnm=:ypnm! and rsvdate>=:start! and rsvdate<=:end!

yuyue03_001=select distinct r.* from tblreservation r where r.rsvgctnm=:rsvgctnm! and r.ypnm=:ypnm! and r.rsvsta='reservated'

yuyue04_000=select distinct ictnm,icttel,ictaddr,fdtpid,pdtnm,sum(fdtqnt)over(partition by ictnm,fdtpid,foldt) as fdtqnt,pdtprc,foldt from (select nvl(f.fdtcltnm,nvl((select c.ictnm from tblindclient c where c.ictid=f.fdtcltid),'000000')) as ictnm,(select c.icttel from tblindclient c where c.ictid=f.fdtcltid) as icttel,(select c.ictaddr from tblindclient c where c.ictid=f.fdtcltid) as ictaddr,f.fdtpid,(select p.pdtnm from tblproduct p where p.pdtid=f.fdtpid) as pdtnm,(case when o.folsta='recpass' then -1 else 1 end) as fdtqnt,(select p.pdtprc from tblproduct p where p.pdtid=f.fdtpid) as pdtprc,o.foldt from tblfoldetail f left join tblfolio o on f.fdtfno=o.folno where o.foldt >= :start! and o.foldt < :end! and o.foltype='make' and o.folsta not in('uncommited','commited','back','disback','wtdis')) union all select distinct ictnm,icttel,ictaddr,fdtpid,pdtnm,sum(fdtqnt)over(partition by ictnm,fdtpid,foldt) as fdtqnt,pdtprc,foldt from (select (select c.ictnm from tblindclient c where c.ictid=g.chgcltid) as ictnm,(select c.icttel from tblindclient c where c.ictid=g.chgcltid) as icttel,(select c.ictaddr from tblindclient c where c.ictid=g.chgcltid) as ictaddr,i.ncdpid as fdtpid,(select p.pdtnm from tblproduct p where p.pdtid=i.ncdpid) as pdtnm,i.ncdqnt as fdtqnt,(select p.pdtprc from tblproduct p where p.pdtid=i.ncdpid) as pdtprc,g.chgdt as foldt from tblnorchgdetail i, tblnorchg g where ((i.ncdsta in ('finish') and g.chgdt >= :start! and g.chgdt < :end! and i.ncdid = g.chgid) or (i.ncdsta in ('nomrecoiled', 'commited', 'pass','back') and i.ncdrecdt >= :start! and i.ncdrecdt < :end! and i.ncdoid = g.chgid)))

yuyue04_001=select distinct ictnm,icttel,ictaddr,fdtpid,pdtnm,sum(fdtqnt)over(partition by ictnm,fdtpid,foldt) as fdtqnt,pdtprc,foldt from (select nvl(f.fdtcltnm,nvl((select c.ictnm from tblindclient c where c.ictid=f.fdtcltid),'000000')) as ictnm,(select c.icttel from tblindclient c where c.ictid=f.fdtcltid) as icttel,(select c.ictaddr from tblindclient c where c.ictid=f.fdtcltid) as ictaddr,f.fdtpid,(select p.pdtnm from tblproduct p where p.pdtid=f.fdtpid) as pdtnm,(case when (o.folsta='recpass' and o.foltype='make') then -1 when (o.folsta!='recpass' and o.foltype='make') then 1 when (o.folsta='finish' and o.foltype='normal') then f.fdtqnt end) as fdtqnt,(select p.pdtprc from tblproduct p where p.pdtid=f.fdtpid) as pdtprc,o.foldt from tbltj f left join tblfolio o on f.fdtfno=o.folno where o.foldt >= :start! and o.foldt < :end! and 1=1)

yuyue04_002=select distinct ictnm,icttel,ictaddr,fdtpid,pdtnm,sum(fdtqnt)over(partition by ictnm,fdtpid,foldt) as fdtqnt,pdtprc,foldt from (select nvl(f.fdtcltnm,nvl((select c.ictnm from tblindclient c where c.ictid=f.fdtcltid),'000000')) as ictnm,(select c.icttel from tblindclient c where c.ictid=f.fdtcltid) as icttel,(select c.ictaddr from tblindclient c where c.ictid=f.fdtcltid) as ictaddr,f.fdtpid,(select p.pdtnm from tblproduct p where p.pdtid=f.fdtpid) as pdtnm,(case when (o.folsta='recpass' and o.foltype='make') then -1 when (o.folsta!='recpass' and o.foltype='make') then 1 when (o.folsta='finish' and o.foltype='normal') then f.fdtqnt end) as fdtqnt,(select p.pdtprc from tblproduct p where p.pdtid=f.fdtpid) as pdtprc,o.foldt from tbltj f left join tblfolio o on f.fdtfno=o.folno where o.foldt >= :start! and o.foldt < to_date('2013-04-26','yyyy-mm-dd')) union all select distinct ictnm,icttel,ictaddr,fdtpid,pdtnm,sum(fdtqnt)over(partition by ictnm,fdtpid,foldt) as fdtqnt,pdtprc,foldt from (select nvl(f.fdtcltnm,nvl((select c.ictnm from tblindclient c where c.ictid=f.fdtcltid),'000000')) as ictnm,(select c.icttel from tblindclient c where c.ictid=f.fdtcltid) as icttel,(select c.ictaddr from tblindclient c where c.ictid=f.fdtcltid) as ictaddr,f.fdtpid,(select p.pdtnm from tblproduct p where p.pdtid=f.fdtpid) as pdtnm,(case when o.folsta='recpass' then -1 else 1 end) as fdtqnt,(select p.pdtprc from tblproduct p where p.pdtid=f.fdtpid) as pdtprc,o.foldt from tblfoldetail f left join tblfolio o on f.fdtfno=o.folno where o.foltype='make' and o.folsta not in ('uncommited','commited','back','disback','wtdis') and o.foldt >= to_date('2013-04-26','yyyy-mm-dd') and o.foldt < :end!) union all select distinct ictnm,icttel,ictaddr,fdtpid,pdtnm,sum(fdtqnt)over(partition by ictnm,fdtpid,foldt) as fdtqnt,pdtprc,foldt from (select (select c.ictnm from tblindclient c where c.ictid=g.chgcltid) as ictnm,(select c.icttel from tblindclient c where c.ictid=g.chgcltid) as icttel,(select c.ictaddr from tblindclient c where c.ictid=g.chgcltid) as ictaddr,i.ncdpid as fdtpid,(select p.pdtnm from tblproduct p where p.pdtid=i.ncdpid) as pdtnm,i.ncdqnt as fdtqnt,(select p.pdtprc from tblproduct p where p.pdtid=i.ncdpid) as pdtprc,g.chgdt as foldt from tblnorchgdetail i, tblnorchg g where ((i.ncdsta in ('finish') and g.chgdt >= to_date('2013-04-26','YYYY-MM-DD') and g.chgdt < :end! and i.ncdid = g.chgid) or (i.ncdsta in ('nomrecoiled', 'commited', 'pass','back') and i.ncdrecdt >= to_date('2013-04-26','YYYY-MM-DD') and i.ncdrecdt < :end! and i.ncdoid = g.chgid)))

cltfctl03_000=select sum(  case when adglre='L' and adgtp ='G' and adgfq =250 then adgadt else null  end) as lg250,  sum(  case when adglre='L' and adgtp ='G' and adgfq =500 then adgadt else null  end) as lg500,  sum(  case when adglre='L' and adgtp ='G' and adgfq =750 then adgadt else null  end) as lg750,  sum(  case when adglre='L' and adgtp ='G' and adgfq =1000 then adgadt else null  end) as lg1000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =1500 then adgadt else null  end) as lg1500,  sum(  case when adglre='L' and adgtp ='G' and adgfq =2000 then adgadt else null  end) as lg2000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =3000 then adgadt else null  end) as lg3000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =4000 then adgadt else null  end) as lg4000,  sum(  case when adglre='L' and adgtp ='G' and adgfq =6000 then adgadt else null  end) as lg6000,  round(avg(  case when adglre='L' and adgtp ='G' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as lgavg,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =250 then adgadt else null  end) as lq250,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =500 then adgadt else null  end) as lq500,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =750 then adgadt else null  end) as lq750,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =1000 then adgadt else null  end) as lq1000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =1500 then adgadt else null  end) as lq1500,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =2000 then adgadt else null  end) as lq2000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =3000 then adgadt else null  end) as lq3000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =4000 then adgadt else null  end) as lq4000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =6000 then adgadt else null  end) as lq6000,  round(avg(  case when adglre='L' and adgtp ='Q' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as lqavg,  sum(  case when adglre='R' and adgtp ='G' and adgfq =250 then adgadt else null  end) as rg250,  sum(  case when adglre='R' and adgtp ='G' and adgfq =500 then adgadt else null  end) as rg500,  sum(  case when adglre='R' and adgtp ='G' and adgfq =750 then adgadt else null  end) as rg750,  sum(  case when adglre='R' and adgtp ='G' and adgfq =1000 then adgadt else null  end) as rg1000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =1500 then adgadt else null  end) as rg1500,  sum(  case when adglre='R' and adgtp ='G' and adgfq =2000 then adgadt else null  end) as rg2000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =3000 then adgadt else null  end) as rg3000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =4000 then adgadt else null  end) as rg4000,  sum(  case when adglre='R' and adgtp ='G' and adgfq =6000 then adgadt else null  end) as rg6000,  round(avg(  case when adglre='R' and adgtp ='G' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as rgavg,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =250 then adgadt else null  end) as rq250,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =500 then adgadt else null  end) as rq500,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =750 then adgadt else null  end) as rq750,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =1000 then adgadt else null  end) as rq1000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =1500 then adgadt else null  end) as rq1500,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =2000 then adgadt else null  end) as rq2000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =3000 then adgadt else null  end) as rq3000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =4000 then adgadt else null  end) as rq4000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =6000 then adgadt else null  end) as rq6000,  round(avg(  case when adglre='R' and adgtp ='Q' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as rqavg from tblfctlgraph where fctlid=:fcttlid! 
cltfctl03_001=select sum( case  when adglre='L'  and adgtp ='G'  and adgfq =250  then adgadt  else null end) as lg250, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =500  then adgadt  else null end) as lg500, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =750  then adgadt  else null end) as lg750, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =1000  then adgadt  else null end) as lg1000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =1500  then adgadt  else null end) as lg1500, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =2000  then adgadt  else null end) as lg2000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =3000  then adgadt  else null end) as lg3000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =4000  then adgadt  else null end) as lg4000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =6000  then adgadt  else null end) as lg6000, round(avg( case  when adglre='L'  and adgtp ='G'  and adgfq in ('500','1000','2000')  then adgadt  else null end),2) as lgavg, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =250  then adgadt  else null end) as lq250, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =500  then adgadt  else null end) as lq500, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =750  then adgadt  else null end) as lq750, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =1000  then adgadt  else null end) as lq1000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =1500  then adgadt  else null end) as lq1500, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =2000  then adgadt  else null end) as lq2000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =3000  then adgadt  else null end) as lq3000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =4000  then adgadt  else null end) as lq4000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =6000  then adgadt  else null end) as lq6000, round(avg( case  when adglre='L'  and adgtp ='Q'  and adgfq in ('500','1000','2000')  then adgadt  else null end),2) as lqavg, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =250  then adgadt  else null end) as rg250, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =500  then adgadt  else null end) as rg500, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =750  then adgadt  else null end) as rg750, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =1000  then adgadt  else null end) as rg1000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =1500  then adgadt  else null end) as rg1500, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =2000  then adgadt  else null end) as rg2000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =3000  then adgadt  else null end) as rg3000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =4000  then adgadt  else null end) as rg4000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =6000  then adgadt  else null end) as rg6000, round(avg( case  when adglre='R'  and adgtp ='G'  and adgfq in ('500','1000','2000')  then adgadt  else null end),2) as rgavg, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =250  then adgadt  else null end) as rq250, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =500  then adgadt  else null end) as rq500, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =750  then adgadt  else null end) as rq750, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =1000  then adgadt  else null end) as rq1000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =1500  then adgadt  else null end) as rq1500, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =2000  then adgadt  else null end) as rq2000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =3000  then adgadt  else null end) as rq3000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =4000  then adgadt  else null end) as rq4000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =6000  then adgadt  else null end) as rq6000, round(avg( case  when adglre='R'  and adgtp ='Q'  and adgfq in ('500','1000','2000')  then adgadt  else null end),2) as rqavg, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =250  then adgshie  else null end) as lgyb250, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =500  then adgshie  else null end) as lgyb500, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =750  then adgshie  else null end) as lgyb750, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =1000  then adgshie  else null end) as lgyb1000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =1500  then adgshie  else null end) as lgyb1500, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =2000  then adgshie  else null end) as lgyb2000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =3000  then adgshie  else null end) as lgyb3000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =4000  then adgshie  else null end) as lgyb4000, sum( case  when adglre='L'  and adgtp ='G'  and adgfq =6000  then adgshie  else null end) as lgyb6000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =250  then adgshie  else null end) as lqyb250, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =500  then adgshie  else null end) as lqyb500, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =750  then adgshie  else null end) as lqyb750, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =1000  then adgshie  else null end) as lqyb1000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =1500  then adgshie  else null end) as lqyb1500, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =2000  then adgshie  else null end) as lqyb2000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =3000  then adgshie  else null end) as lqyb3000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =4000  then adgshie  else null end) as lqyb4000, sum( case  when adglre='L'  and adgtp ='Q'  and adgfq =6000  then adgshie  else null end) as lqyb6000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =250  then adgshie  else null end) as rgyb250, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =500  then adgshie  else null end) as rgyb500, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =750  then adgshie  else null end) as rgyb750, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =1000  then adgshie  else null end) as rgyb1000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =1500  then adgshie  else null end) as rgyb1500, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =2000  then adgshie  else null end) as rgyb2000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =3000  then adgshie  else null end) as rgyb3000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =4000  then adgshie  else null end) as rgyb4000, sum( case  when adglre='R'  and adgtp ='G'  and adgfq =6000  then adgshie  else null end) as rgyb6000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =250  then adgshie  else null end) as rqyb250, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =500  then adgshie  else null end) as rqyb500, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =750  then adgshie  else null end) as rqyb750, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =1000  then adgshie  else null end) as rqyb1000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =1500  then adgshie  else null end) as rqyb1500, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =2000  then adgshie  else null end) as rqyb2000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =3000  then adgshie  else null end) as rqyb3000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =4000  then adgshie  else null end) as rqyb4000, sum( case  when adglre='R'  and adgtp ='Q'  and adgfq =6000  then adgshie  else null end) as rqyb6000 from tblfctlgraph where fctlid=:fcttlid!
cltfctl03_002=select sum(  case when adglre='L' and adgtp ='S' and adgfq =250 then adgadt else null  end) as ls250,  sum(  case when adglre='L' and adgtp ='S' and adgfq =500 then adgadt else null  end) as ls500,  sum(  case when adglre='L' and adgtp ='S' and adgfq =750 then adgadt else null  end) as ls750,  sum(  case when adglre='L' and adgtp ='S' and adgfq =1000 then adgadt else null  end) as ls1000,  sum(  case when adglre='L' and adgtp ='S' and adgfq =1500 then adgadt else null  end) as ls1500,  sum(  case when adglre='L' and adgtp ='S' and adgfq =2000 then adgadt else null  end) as ls2000,  sum(  case when adglre='L' and adgtp ='S' and adgfq =3000 then adgadt else null  end) as ls3000,  sum(  case when adglre='L' and adgtp ='S' and adgfq =4000 then adgadt else null  end) as ls4000,  sum(  case when adglre='L' and adgtp ='S' and adgfq =6000 then adgadt else null  end) as ls6000,  round(avg(  case when adglre='L' and adgtp ='S' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as lsavg,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =250 then adgadt else null  end) as lq250,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =500 then adgadt else null  end) as lq500,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =750 then adgadt else null  end) as lq750,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =1000 then adgadt else null  end) as lq1000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =1500 then adgadt else null  end) as lq1500,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =2000 then adgadt else null  end) as lq2000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =3000 then adgadt else null  end) as lq3000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =4000 then adgadt else null  end) as lq4000,  sum(  case when adglre='L' and adgtp ='Q' and adgfq =6000 then adgadt else null  end) as lq6000,  round(avg(  case when adglre='L' and adgtp ='Q' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as lqavg,  sum(  case when adglre='R' and adgtp ='S' and adgfq =250 then adgadt else null  end) as rs250,  sum(  case when adglre='R' and adgtp ='S' and adgfq =500 then adgadt else null  end) as rs500,  sum(  case when adglre='R' and adgtp ='S' and adgfq =750 then adgadt else null  end) as rs750,  sum(  case when adglre='R' and adgtp ='S' and adgfq =1000 then adgadt else null  end) as rs1000,  sum(  case when adglre='R' and adgtp ='S' and adgfq =1500 then adgadt else null  end) as rs1500,  sum(  case when adglre='R' and adgtp ='S' and adgfq =2000 then adgadt else null  end) as rs2000,  sum(  case when adglre='R' and adgtp ='S' and adgfq =3000 then adgadt else null  end) as rs3000,  sum(  case when adglre='R' and adgtp ='S' and adgfq =4000 then adgadt else null  end) as rs4000,  sum(  case when adglre='R' and adgtp ='S' and adgfq =6000 then adgadt else null  end) as rs6000,  round(avg(  case when adglre='R' and adgtp ='S' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as rsavg,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =250 then adgadt else null  end) as rq250,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =500 then adgadt else null  end) as rq500,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =750 then adgadt else null  end) as rq750,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =1000 then adgadt else null  end) as rq1000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =1500 then adgadt else null  end) as rq1500,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =2000 then adgadt else null  end) as rq2000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =3000 then adgadt else null  end) as rq3000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =4000 then adgadt else null  end) as rq4000,  sum(  case when adglre='R' and adgtp ='Q' and adgfq =6000 then adgadt else null  end) as rq6000,  round(avg(  case when adglre='R' and adgtp ='Q' and adgfq in ('500','1000','2000') then adgadt else null  end),2) as rqavg from tblfctlgraph where fctlid=:fcttlid! 
 