#####################################################################################################################
#																													#
#---------------------------------------sql\u8bed\u53e5\u5b9a\u4e49\u89c4\u5219---------------------------------------------------------------#
# * \u53d6\u83dc\u5355\u7f16\u53f7\u524d\u4e09\u4f4d+5\u4f4d\u987a\u5e8f\u53f7																		#
# * \u4f8b\u5982\uff1a\u57fa\u672c\u4fe1\u606f \u5355\u4f4d\u7ba1\u7406 bas01_000 bas--\u57fa\u7840\u4fe1\u606f\u6a21\u5757 01--\u5355\u4f4d\u7ba1\u7406  000--\u5f53\u524d\u5f00\u53d1\u4f7f\u7528sql\u987a\u5e8f\u53f7				#
# *      \u57fa\u672c\u4fe1\u606f \u4eba\u5458\u7ba1\u7406 bas02_000 bas--\u57fa\u7840\u4fe1\u606f\u6a21\u5757 02--\u4eba\u5458\u7ba1\u7406  000--\u5f53\u524d\u5f00\u53d1\u4f7f\u7528sql\u987a\u5e8f\u53f7				#
# *      \u57fa\u672c\u4fe1\u606f \u4eba\u5458\u7ba1\u7406 bas02_000 bas--\u57fa\u7840\u4fe1\u606f\u6a21\u5757 02--\u4eba\u5458\u7ba1\u7406  000--\u5f53\u524d\u5f00\u53d1\u4f7f\u7528sql\u987a\u5e8f\u53f7				#
# * \u5177\u4f53\u7f16\u5199\u683c\u5f0f\u4e3e\u4f8b\uff1a																			#
# * #\u5355\u4f4d\u7ba1\u7406#																					#
# * bas01_000=select * from ab01 where aab001=:aab001 and aab004=:aab004						#
# * bas02_002=select * from ab01 where aab002=:aab002 and aab003=:aab003						#
# * 																							#
# * #\u4eba\u5458\u7ba1\u7406#																					#
# * bas02_000=select * from ac01 where aab001=:aab001 and aab004=:aab004						#
# * bas02_001=select * from ac01 where aab002=:aab002 and aab003=:aab003						#
# * 																							#
######################################################################################################################
#\u5b9a\u5236\u673a\u7ba1\u7406#

bus01_000=select * from tblinventory where ivtyear=:ivtyear! and ivtmonth=:ivtmonth!
#bus01_001=select i.*,(i.ivtlsqnt+i.ivtlmqnt) as temp01,(i.ivtlsqnt+i.ivtlmqnt-i.ivtpqnt) as temp02,p.pdtnm,g.gctnm,decode(g.gcttype,'A',i.ivtdiscount,'C',i.ivtdiscount,d.discount) as discount from tblinventory i left outer join tblproduct p on p.pdtid=i.ivtpdtid left outer join tblgrpclient g on i.ivtgcltid=g.gctid left outer join tbldiscount d on (i.ivttype<>'repair' and d.dispdtid=i.ivtpdtid and d.disgctid=i.ivtgcltid) where i.ivtyear=:ivtyear! and i.ivtmonth=:ivtmonth! and i.ivtgcltid=:ivtgcltid! order by i.ivttype,p.pdtcls,p.pdtnm
#bus01_001=select y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,sum (nvl(ivtlmqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid) as ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+ivtlsqnt) as temp01,ivtnote,(ivtlmqnt+ivtlsqnt-ivtpqnt)as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid and g.gcttype='A' where y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid! order by y.ivttype,p.pdtnm
bus01_001=select y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,y.ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+nvl(y.ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype='A' and y.ivttype<>'normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!  union all select y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,sum (nvl(ivtlmqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid) as ivtlmqnt,sum(nvl(y.ivtlsqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtlsqnt,sum(nvl(y.ivtpqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpqnt,sum(nvl(y.ivtpamnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpamnt,(ivtlmqnt+nvl(ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype='A' and y.ivttype='normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!
bus01_013=select y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,y.ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+nvl(y.ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype='A' and y.ivttype<>'normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!
bus01_014=select y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,sum (nvl(ivtlmqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid) as ivtlmqnt,sum(nvl(y.ivtlsqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtlsqnt,sum(nvl(y.ivtpqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpqnt,sum(nvl(y.ivtpamnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpamnt,(ivtlmqnt+nvl(ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype='A' and y.ivttype='normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!

#bus01_010=select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,y.ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+nvl(y.ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype<>'A' and y.ivttype<>'normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid! union all select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,sum (nvl(ivtlmqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid) as ivtlmqnt,sum(nvl(y.ivtlsqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtlsqnt,sum(nvl(y.ivtpqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpqnt,sum(nvl(y.ivtpamnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpamnt,(ivtlmqnt+nvl(ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype<>'A' and y.ivttype='normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!
#bus01_015=select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,y.ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+nvl(y.ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype<>'A' and y.ivttype<>'normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!
#bus01_016=select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,sum (nvl(ivtlmqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid) as ivtlmqnt,sum(nvl(y.ivtlsqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtlsqnt,sum(nvl(y.ivtpqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpqnt,sum(nvl(y.ivtpamnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpamnt,(ivtlmqnt+nvl(ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where g.gcttype<>'A' and y.ivttype='normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!
bus01_010=select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,y.ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+nvl(y.ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where y.ivttype<>'normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid! union all select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,sum (nvl(ivtlmqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid) as ivtlmqnt,sum(nvl(y.ivtlsqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtlsqnt,sum(nvl(y.ivtpqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpqnt,sum(nvl(y.ivtpamnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpamnt,(ivtlmqnt+nvl(ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where y.ivttype='normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!
bus01_015=select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,y.ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+nvl(y.ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where y.ivttype<>'normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!
bus01_016=select y.ivtid,y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,sum (nvl(ivtlmqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid) as ivtlmqnt,sum(nvl(y.ivtlsqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtlsqnt,sum(nvl(y.ivtpqnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpqnt,sum(nvl(y.ivtpamnt,0))over(partition by ivtyear,ivtmonth,ivtgcltid,ivtpdtid)as ivtpamnt,(ivtlmqnt+nvl(ivtlsqnt,0)) as temp01,ivtnote,(ivtlmqnt+nvl(y.ivtlsqnt,0)-nvl(y.ivtpqnt,0))as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid where y.ivttype='normal' and y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid!

#bus01_001=select y.ivtyear,y.ivtmonth,y.ivtgcltid,y.ivtcltnm,y.ivtpdtid,y.ivttype,g.gctnm,p.pdtnm,y.ivtfee,y.ivtdiscount as discount,y.ivtlmqnt,nvl(y.ivtlsqnt,0)as ivtlsqnt,nvl(y.ivtpqnt,0)as ivtpqnt,nvl(y.ivtpamnt,0)as ivtpamnt,(ivtlmqnt+ivtlsqnt) as temp01,ivtnote,(ivtlmqnt+ivtlsqnt-ivtpqnt)as temp02,y.ivturgfee from tblinventory y left join tblgrpclient g on y.ivtgcltid=g.gctid left join tblindclient c on y.ivtcltid=c.ictid left join tblproduct p on y.ivtpdtid=p.pdtid and g.gcttype='A' where y.ivtyear=:ivtyear! and y.ivtmonth=:ivtmonth! and y.ivtgcltid=:ivtgcltid! order by y.ivttype,p.pdtnm
#bus01_002=select t.tmpgctid as gctid,t.tmppdtnm as stogrpnm,g.gctnm,t.tmpamount as storqnt,t.tmpdate as stodate,trunc(sysdate)-trunc(t.tmpdate)-g.gctexd as days from tbltmp t left outer join tblgrpclient g on g.gctid=t.tmpgctid where g.gctnm=:gctnm! and t.tmppdtnm=:stogrpnm!
#bus01_002=select g.gctnm,g.gctarea,p.pdtprc,p.pdtnm as stogrpnm,h.folsdt as stodate,p.pdtcls,d.fdtqnt as storqnt,i.ictnm,trunc(sysdate)-trunc(h.folsdt)-g.gctexd as days from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient i on i.ictid=d.fdtcltid where g.gctnm like :gctnm! and p.pdtnm like :stogrpnm! and g.gcttype='A' and g.gctarea=:gctarea! and d.fdtqnt>0 and h.foltype='make' and h.folischg<>'1' and p.pdtnm not in ('\u786c\u8033\u6a21','\u8f6f\u8033\u6a21','\u5f3a\u529b\u8033\u585e','\u5168\u5f00\u653e\u5f0f\u786c\u8033\u6a21','\u786c\u8033\u6a21 \u52a0\u5b57') union select  g.gctnm,g.gctarea,p.pdtprc,p.pdtnm as stogrpnm,m.tmpdate as stodate,p.pdtcls,m.tmpamount as storqnt,'ictnm',trunc(sysdate)-trunc(m.tmpdate)-g.gctexd as days from tbltmp m left outer join tblproduct p on p.pdtid=m.tmppdtid left outer join tblgrpclient g on g.gctid=m.tmpgctid where  g.gcttype='A' and g.gctarea=:gctarea! and m.tmpgctid<>'1501000000' and  p.pdtnm in  (select pdtnm from tblproduct where pdtnm like'%\u76d2\u5f0f\u673a%' or pdtnm like '%\u8033\u80cc\u673a%') and p.pdtcls<>'OTH' and p.pdtprc>=(case when p.pdtnm like '%\u8033\u80cc\u673a%' then :prices! else  '0' end) and g.gctnm like :gctnm! and p.pdtnm like :stogrpnm!

#before20130412 bus01_002=select g.gctnm,g.gctarea,p.pdtprc,p.pdtnm as stogrpnm,h.folsdt as stodate,p.pdtcls,d.fdtqnt as storqnt,i.ictnm,trunc(sysdate)-trunc(h.folsdt)-g.gctexd as days from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient i on i.ictid=d.fdtcltid where d.fdtqnt>0 and h.foltype='make' and ((h.folischg='0' and h.folsta ='finish') or (h.folischg ='1' and h.folsta in ('charged','recoiledhead','recoiled','recpass'))) and p.pdtid not in ('999605','999601','999604','999602') and g.gctnm like :gctnm! and p.pdtnm like :stogrpnm! and g.gctarea=:gctarea! and g.gcttype='A' union select g.gctnm,g.gctarea,p.pdtprc,p.pdtnm as stogrpnm,m.tmpdate as stodate,p.pdtcls,m.tmpamount as storqnt,'ictnm',trunc(sysdate)-trunc(m.tmpdate)-g.gctexd as days from tbltmp m left outer join tblproduct p on p.pdtid=m.tmppdtid left outer join tblgrpclient g on g.gctid=m.tmpgctid where  g.gcttype='A' and g.gctarea=:gctarea! and m.tmpgctid<>'1501000000' and  p.pdtnm in  (select pdtnm from tblproduct where pdtnm like'%\u76d2\u5f0f\u673a%' or pdtnm like '%\u8033\u80cc\u673a%') and p.pdtcls<>'OTH' and p.pdtprc>=(case when p.pdtnm like '%\u8033\u80cc\u673a%' then :prices! else  '0' end) and g.gctnm like :gctnm! and p.pdtnm like :stogrpnm!
bus01_002=select g.gctnm,g.gctarea,p.pdtprc,p.pdtnm as stogrpnm,h.folsdt as stodate,p.pdtcls,d.fdtqnt as storqnt,i.ictnm,trunc(sysdate)-trunc(h.folsdt)-g.gctexd as days from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient i on i.ictid=d.fdtcltid where d.fdtqnt>0 and h.foltype in ('make','makeEar') and ((h.folischg='0' and h.folsta in ('finish','recoiledhead','recoiled','recback')) or (h.folischg ='1' and h.folsta in ('recoiledhead','recoiled','recback'))) and p.pdtid not in ('999605','999601','999604','999602') and g.gctnm like :gctnm! and p.pdtnm like :stogrpnm! and g.gctarea=:gctarea! and g.gcttype='A' 
bus01_012=select g.gctnm,g.gctarea,p.pdtprc,p.pdtnm as stogrpnm,m.tmpdate as stodate,p.pdtcls,m.tmpamount as storqnt,'ictnm',trunc(sysdate)-trunc(m.tmpdate)-g.gctexd as days from tbltmp m left outer join tblproduct p on p.pdtid=m.tmppdtid left outer join tblgrpclient g on g.gctid=m.tmpgctid where  g.gcttype='A' and g.gctarea=:gctarea! and m.tmpgctid<>'1501000000' and  p.pdtnm in  (select pdtnm from tblproduct where pdtnm like'%\u76d2\u5f0f\u673a%' or pdtnm like '%\u8033\u80cc\u673a%') and p.pdtcls<>'OTH' and p.pdtprc>=(case when p.pdtcls='BOX' then :pricesbox! else '0' end) and p.pdtprc>=(case when p.pdtnm like '%\u8033\u80cc\u673a%' then :prices! else  '0' end) and g.gctnm like :gctnm! and p.pdtnm like :stogrpnm!

#\u76f4\u5c5e\u5e97\u9884\u6708\u7ed3
bus01_003=select * from tblinventory where ivtyear=:ivtyear! and ivtmonth=:ivtmonth! and ivtgcltid=:ivtgcltid!
bus01_008=select distinct i.ivtgcltid,i.ivtyear,i.ivtmonth,g.gctnm,g.gctprovince,g.gctarea from tblinventory i left outer join tblgrpclient g on g.gctid=i.ivtgcltid where i.ivtyear=:ivtyear! and i.ivtmonth=:ivtmonth! and i.ivtgcltid=:ivtgcltid! and g.gctprovince=:gctprovince! and g.gctarea=:gctarea! and g.gcttype='A'and g.gctnm=:gctnm!

#\u52a0\u76df\u5e97\u7ed3\u8d26\u63d2\u5165tblactsta\u8868
bus01_004=insert into tblactsta (actstaid, actstayear, actstamonth, actstagcltid, actsta,  actmqnt, actsqnt) values (:actstaid!, :actstayear!, :actstamonth!, :actstagcltid!, :actsta!,  :actmqnt!, :actsqnt!)
bus01_005=select t.actstayear,t.actstamonth,t.actstagcltid,g.gctnm,g.gctarea,t.actsta,t.actstanote from tblgrpclient g left outer join tblactsta t on g.gctid = t.actstagcltid where not exists (select gctid from tblgrpclient p where gcttype='A' and gctvalid='0' and p.gctid=t.actstagcltid) 

bus01_009=select t.actstayear,t.actstamonth,t.actstagcltid,g.gctnm,g.gctarea,t.actsta,t.actstanote,x.totalysk as totalysk from(select ivtgcltid,y.ivtyear,y.ivtmonth,sum(y.ivtpamnt) as totalysk from  tblinventory y where y.ivtyear=:actstayear! and y.ivtmonth=:actstamonth! 
#bus01_011=select x.ivtyear as actstayear,x.ivtmonth as actstamonth,x.ivtgcltid as  actstagcltid,x.gctnm ,x.gctarea,x.totalysk from (select y.ivtgcltid,y.ivtyear,y.ivtmonth,sum(y.ivtpamnt) as totalysk,g.gctnm,g.gctarea  from  tblinventory y left outer join tblgrpclient g on g.gctid=y.ivtgcltid where y.ivtyear=:actstayear! and y.ivtmonth=:actstamonth! and y.ivtgcltid=:actstagcltid! and g.gctarea=:gctarea! and g.gcttype<>'A' group by y.ivtgcltid,y.ivtyear,y.ivtmonth,g.gctnm,gctarea)x
bus01_011=select x.ivtyear as actstayear,x.ivtmonth as actstamonth,x.ivtgcltid as  actstagcltid,x.gctnm ,x.gctarea,x.totalysk from (select y.ivtgcltid,y.ivtyear,y.ivtmonth,sum(y.ivtpamnt) as totalysk,g.gctnm,g.gctarea  from  tblinventory y left outer join tblgrpclient g on g.gctid=y.ivtgcltid where y.ivtyear=:actstayear! and y.ivtmonth=:actstamonth! and y.ivtgcltid=:actstagcltid! and g.gctarea=:gctarea! and g.gctvalid='1' group by y.ivtgcltid,y.ivtyear,y.ivtmonth,g.gctnm,gctarea)x
#bus03_004=select * from (select  h.folnt,g.gctnm,g.gctarea,g.gctprovince, p.pdtnm,p.pdtprc,(d.fdtprc+nvl(h.folurgrfee,0)) as fdtprc,d.fdtqnt,h.folchgdt as folchgdt,nvl(c.ictnm,d.fdtcltnm) as cltnm,d.fdtdisc,d.fdtypname as ncdypname,d.fdtisspdisc,h.foltype,d.fdtrecmon as recmoney,fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid=d.fdtcltid where 1=1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and g.gctarea=:gctarea! and h.folchgdt>=:start! and h.folchgdt<=:end! and h.foltype<>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and d.fdtypname like:ncdypname! and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union all select h.folnt,g.gctnm,g.gctarea,g.gctprovince, p.pdtnm,p.pdtprc,(case when h.folischg='0' then h.foldps-d.fdtrecmon else -d.fdtrecmon end) as fdtprc,-d.fdtqnt as fdtqnt,d.fdtodt as folchgdt,nvl(c.ictnm,d.fdtcltnm) as cltnm,d.fdtdisc,d.fdtypname as ncdypname,d.fdtisspdisc,h.foltype,d.fdtrecmon as recmoney,fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid=d.fdtcltid where 1=1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and g.gctarea=:gctarea! and d.fdtodt>=:start! and d.fdtodt<=:end! and h.foltype<>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and d.fdtypname like:ncdypname! and h.folsta in ('recoiled','recpass','recoiledhead','recback'))order by gctnm,gctarea,gctprovince,cltnm,pdtnm
#bus03_005=select * from (select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,n.chgdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and n.chgdt>=:start! and n.chgdt<=:end! and p.pdttype=:pdttype! and 2=2 and g.GCTTYPE<>'A' union all select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,r.ncdrecdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdoid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where 1=1 and g.gctnm=:gctnm! and g.GCTTYPE<>'A' and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and r.ncdrecdt>=:start! and r.ncdrecdt<=:end! and p.pdttype=:pdttype! and 2=2 ) order by gctnm,gctarea,gctprovince,cltnm,pdtnm
bus03_006=select * from (select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,n.chgdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and n.chgdt>=:start! and n.chgdt<=:end! and p.pdttype=:pdttype! and 2=2 and g.GCTTYPE='A' union all select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,r.ncdrecdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdoid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where 1=1 and g.gctnm=:gctnm! and g.GCTTYPE='A' and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and r.ncdrecdt>=:start! and r.ncdrecdt<=:end! and p.pdttype=:pdttype! and 2=2 ) order by gctnm,gctarea,gctprovince,cltnm,pdtnm
bus03_004=select * from (select h.folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, p.pdtprc, (d.fdtprc+nvl(h.folurgrfee,0)) as fdtprc, d.fdtqnt, h.folchgdt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and g.gctarea =:gctarea! and h.folchgdt>=:start! and h.folchgdt<=:end! and h.foltype <>'normal' and h.foltype =:foltype! and p.pdttype =:pdttype! and d.fdtypname like:ncdypname! and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union all select h.folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, p.pdtprc, ( case when h.folischg='0' then h.foldps-d.fdtrecmon else -d.fdtrecmon end) as fdtprc, -d.fdtqnt as fdtqnt, d.fdtodt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and g.gctarea =:gctarea! and d.fdtodt >=:start! and d.fdtodt <=:end! and h.foltype<>'normal' and h.foltype =:foltype! and p.pdttype =:pdttype! and d.fdtypname like:ncdypname! and h.folsta in ('recoiled','recpass','recoiledhead','recback') union all select '\u52a0\u6025\u8d39' as folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, h.folurgfee as pdtprc, h.folurgrfee as fdtprc, 1 as fdtqnt, h.folchgdt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and g.gctarea =:gctarea! and d.fdtodt >=:start! and d.fdtodt <=:end! and h.foltype<>'normal' and h.foltype =:foltype! and p.pdttype =:pdttype! and d.fdtypname like:ncdypname! and h.folurgrfee<>'0' and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union all select '\u7EED\u4FDD\u8D39' as folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, h.feeleft+h.feeright as pdtprc, h.leftpay+h.rightpay as fdtprc, 1 as fdtqnt, h.folchgdt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and g.gctarea =:gctarea! and d.fdtodt >=:start! and d.fdtodt <=:end! and h.foltype<>'normal' and h.foltype =:foltype! and p.pdttype =:pdttype! and d.fdtypname like:ncdypname! and (h.leftpay <>0 or rightpay <>0) and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback')) where 1=1 and cltnm like:cltnm! order by gctnm, gctarea, gctprovince, cltnm, pdtnm 
bus03_005=select * from (select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,n.chgdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and n.chgdt>=:start! and n.chgdt<=:end! and p.pdttype=:pdttype! and 2=2 and g.GCTTYPE<>'A' union all select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,r.ncdrecdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdoid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where 1=1 and g.gctnm=:gctnm! and g.GCTTYPE<>'A' and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and r.ncdrecdt>=:start! and r.ncdrecdt<=:end! and p.pdttype=:pdttype! and 2=2 ) order by gctnm,gctarea,gctprovince,cltnm,pdtnm
#bus01_005=select t.actstayear,t.actstamonth,t.actstagcltid,g.gctnm,g.gctarea,t.actsta,t.actstanote from tblgrpclient g left outer join tblactsta t on g.gctid = t.actstagcltid where not existg.gcttype<>'A' and g.gctvalid<>'0'
bus01_006=update tblactsta set actstanote=:mnote! where actstayear=:myear! and actstamonth=:mmonth! and actstagcltid=:mgctid!
bus01_007=update tblactsta set actsta=:actsta! where actstayear=:ivtyear! and actstamonth=:ivtmonth! and actstagcltid=:ivtgcltid!

bus02_000=update tbldiscount set discount=:discount! where disgctid=:ivtgcltid! and dispdtid=:ivtpdtid!
bus02_001=delete from tbltmp
del_amo=delete from tblfeeamortize where feeamoid=:feeamoid!
bus02_002=select distinct gctexd from tblgrpclient where gcttype='A'
bus02_003=update tblgrpclient set gctexd=:gctexd! where gcttype='A'

bus03_000=update tbldiscount set discount=:discount!,disprice=:ivtpamnt! where dispdtid=:ivtpdtid! and disgctid=:ivtgcltid!
#bus03_001=select * from (select  h.folnt,g.gctnm,g.gctarea,g.gctprovince, p.pdtnm,p.pdtprc,(d.fdtprc+nvl(h.folurgrfee,0)) as fdtprc,d.fdtqnt,h.folchgdt as folchgdt,nvl(c.ictnm,d.fdtcltnm) as cltnm,d.fdtdisc,d.fdtypname as ncdypname,d.fdtisspdisc,h.foltype,d.fdtrecmon as recmoney,fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid=d.fdtcltid where 1=1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and g.gctarea=:gctarea! and h.folchgdt>=:start! and h.folchgdt<=:end! and h.foltype<>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and g.gcttype='A' and d.fdtypname like:ncdypname! and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union all select h.folnt,g.gctnm,g.gctarea,g.gctprovince, p.pdtnm,p.pdtprc,(case when h.folischg='0' then h.foldps-d.fdtrecmon else -d.fdtrecmon end) as fdtprc,-d.fdtqnt as fdtqnt,d.fdtodt as folchgdt,nvl(c.ictnm,d.fdtcltnm) as cltnm,d.fdtdisc,d.fdtypname as ncdypname,d.fdtisspdisc,h.foltype,d.fdtrecmon as recmoney,fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid=d.fdtcltid where 1=1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and g.gctarea=:gctarea! and d.fdtodt>=:start! and d.fdtodt<=:end! and h.foltype<>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and g.gcttype='A' and d.fdtypname like:ncdypname! and h.folsta in ('recoiled','recpass','recoiledhead','recback'))order by gctnm,gctarea,gctprovince,cltnm,pdtnm
bus03_001=select * from (select h.folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, p.pdtprc, (d.fdtprc+nvl(h.folurgrfee,0)) as fdtprc, d.fdtqnt, h.folchgdt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and g.gctarea =:gctarea! and h.folchgdt>=:start! and h.folchgdt<=:end! and h.foltype <>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and g.gcttype ='A' and d.fdtypname like:ncdypname! and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union all select h.folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, p.pdtprc, ( case when h.folischg='0' then h.foldps-d.fdtrecmon else -d.fdtrecmon end) as fdtprc, -d.fdtqnt as fdtqnt, d.fdtodt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and g.gctarea =:gctarea! and d.fdtodt >=:start! and d.fdtodt <=:end! and h.foltype<>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and g.gcttype ='A' and d.fdtypname like:ncdypname! and h.folsta in ('recoiled','recpass','recoiledhead','recback') union all select '\u52a0\u6025\u8d39' as folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, h.folurgfee as pdtprc, h.folurgrfee as fdtprc, 1 as fdtqnt, h.folchgdt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and h.folurgrfee<>0 and g.gctnm =:gctnm! and p.pdtnm like:pdtnm!  and g.gctarea =:gctarea! and d.fdtodt >=:start! and d.fdtodt <=:end! and h.foltype<>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and g.gcttype ='A' and d.fdtypname like:ncdypname! and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union all select '\u7EED\u4FDD\u8D39' as folnt, g.gctnm, g.gctarea, g.gctprovince, p.pdtnm, h.feeleft+h.feeright as pdtprc, h.leftpay+h.rightpay as fdtprc, 1 as fdtqnt, h.folchgdt as folchgdt, nvl(c.ictnm,d.fdtcltnm) as cltnm, d.fdtdisc, d.fdtypname as ncdypname, d.fdtisspdisc, h.foltype, d.fdtrecmon as recmoney, fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid =d.fdtcltid where 1 =1 and h.folurgrfee<>0 and g.gctnm =:gctnm! and p.pdtnm like:pdtnm! and g.gctarea =:gctarea! and d.fdtodt >=:start! and d.fdtodt <=:end! and h.foltype<>'normal' and h.foltype = :foltype! and p.pdttype = :pdttype! and g.gcttype ='A' and d.fdtypname like:ncdypname! and (h.leftpay<>0 or rightpay<>0) and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback'))where 1=1 and cltnm like:cltnm! order by gctnm, gctarea, gctprovince, cltnm, pdtnm 
#bus03_002=select distinct g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,n.chgdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and n.chgdt>=:start! and n.chgdt<=:end! and r.ncdrecdt>=:start! and r.ncdrecdt<=:end! and p.pdttype=:pdttype! union all select distinct g1.gctnm,g1.gctarea,g1.gctprovince,p1.pdtnm,p1.pdtprc,r1.ncdmon as fdtprc,r1.ncdqnt as fdtqnt,r1.ncdrecdt as folchgdt,c1.ictnm as cltnm,r1.ncddis as fdtdisc,r1.ncdypname,r1.ncdisspdisc as fdtisspdisc,'normal' as foltype,r1.ncdrecmon as recmoney,fuc_getstatusnor(r1.ncdid,r1.ncdpid) as sta,r1.ncdrecdt as fdtodt from tblnorchg n1 left outer join tblnorchgdetail r1 on r1.ncdoid=n1.chgid join tblproduct p1 on p1.pdtid=r1.ncdpid left outer join tblgrpclient g1 on g1.gctid=n1.chggcltid  left outer join tblindclient c1 on c1.ictid=n1.chgcltid where 1=1 and g1.gctnm=:gctnm! and p1.pdtnm like:pdtnm! and c1.ictnm like:cltnm! and r1.ncdypname like:ncdypname! and g1.gctarea=:gctarea! and n1.chgdt>=:start! and n1.chgdt<=:end! and r1.ncdrecdt>=:start! and r1.ncdrecdt<=:end! and p1.pdttype=:pdttype!))order by gctnm,gctarea,gctprovince,cltnm,pdtnm
bus03_002=select * from (select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,n.chgdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and n.chgdt>=:start! and n.chgdt<=:end! and p.pdttype=:pdttype! and 2=2 union all select  r.ncdnt as folnt,g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,r.ncdrecdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdoid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where 1=1 and g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and r.ncdrecdt>=:start! and r.ncdrecdt<=:end! and p.pdttype=:pdttype! and 2=2 ) order by gctnm,gctarea,gctprovince,cltnm,pdtnm
bus03_003=select distinct g.gctnm,g.gctarea,g.gctprovince, p.pdtnm,p.pdtprc,d.fdtprc,d.fdtqnt,h.folchgdt,nvl(c.ictnm,d.fdtcltnm) as cltnm,d.fdtdisc,d.fdtypname as ncdypname,d.fdtisspdisc,h.foltype,d.fdtrecmon as recmoney,fuc_getstatus(h.folno) as sta, d.fdtodt from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid=d.fdtcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and g.gctarea=:gctarea! and h.folchgdt>=:start! and h.folchgdt<=:end! and d.fdtodt>=:stui! and d.fdtodt<=:etui! and h.foltype<> 'normal' and p.pdttype=:pdttype! and d.fdtypname like:ncdypname! and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union select distinct g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,n.chgdt as folchgdt,c.ictnm as cltnm,r.ncddis as fdtdisc,r.ncdypname,r.ncdisspdisc as fdtisspdisc,'normal' as foltype,r.ncdrecmon as recmoney,fuc_getstatusnor(r.ncdid,r.ncdpid) as sta,r.ncdrecdt as fdtodt from tblnorchg n left outer join tblnorchgdetail r on r.ncdid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and n.chgdt>=:start! and n.chgdt<=:end! and r.ncdrecdt>=:stui! and r.ncdrecdt<=:etui! and p.pdttype=:pdttype!
#bus03_003=select distinct g.gctnm,g.gctarea,g.gctprovince, p.pdtnm,p.pdtprc,d.fdtprc,d.fdtqnt,h.folchgdt,c.ictnm as cltnm,d.fdtdisc,d.fdtypname as ncdypname,d.fdtisspdisc from tblfoldetail d left outer join tblfolio h on h.folno=d.fdtfno left outer join tblproduct p on p.pdtid=d.fdtpid left outer join tblgrpclient g on g.gctid=h.folctid left outer join tblindclient c on c.ictid=d.fdtcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and g.gctarea=:gctarea! and h.folchgdt>=:start! and h.folchgdt<=:end! and h.foltype<> 'normal' and p.pdttype=:pdttype! and g.gcttype='A' and d.fdtypname like:ncdypname! and h.folsta in ('charged','recoiled','recpass','recoiledhead','recback') union select distinct g.gctnm,g.gctarea,g.gctprovince,p.pdtnm,p.pdtprc,r.ncdmon as fdtprc,r.ncdqnt as fdtqnt,n.chgdt as folchgdt,c.ictnm as cltnm,r.ncddis,r.ncdypname,r.ncdisspdisc from tblnorchg n left outer join tblnorchgdetail r on r.ncdid=n.chgid join tblproduct p on p.pdtid=r.ncdpid left outer join tblgrpclient g on g.gctid=n.chggcltid  left outer join tblindclient c on c.ictid=n.chgcltid where g.gctnm=:gctnm! and p.pdtnm like:pdtnm! and c.ictnm like:cltnm! and r.ncdypname like:ncdypname! and g.gctarea=:gctarea! and n.chgdt>=:start! and n.chgdt<=:end! and p.pdttype=:pdttype!
bus03_0004=insert into tblrepdiscount (rdispdtid,rdisgctid,rdisprice,rdiscount,rdisyear,rdismonth,rivtid)values(:ivtpdtid!,:ivtgcltid!,:ivtpamnt!,:discount!,:ivtyear!,:ivtmonth!,:ivtid!)
bus03_0005=update tblrepdiscount set rdisprice=:ivtpamnt!,rdiscount=:discount! where rdispdtid=:ivtpdtid! and rdisgctid=:ivtgcltid! and rdisyear=:ivtyear! and rdismonth=:ivtmonth! and rivtid=:ivtid!
#\u56fa\u5b9a\u8d44\u4ea7
bus04_000=select s.*,g.gctnm as astgctnm from tblasset s left outer join tblgrpclient g on g.gctid=s.astgctid where s.astgctid=:astgctid! and s.astpdtnm=:astpdtnm! and s.astut=:pdtut! and astdt >= :start! and astdt <=:end!
bus04_001=insert into tblasset (astid, astgctid, astpdtnm, astopr, astqnt, astdt, astnote, astut, astprc) values (:astid!, :astgctid!, :astpdtnm!, :astopr!, :astqnt!, :astdt!, :astnote!, :astut!, :astprc!)
bus04_002=select s.astpdtnm,s.astqnt,s.astdt,s.astnote,s.astut,s.astprc,c.bsc012 as astopr,g.gctnm as astgctnm from tblasset s left outer join tblgrpclient g on g.gctid=s.astgctid left outer join sc05 c on c.bsc011=s.astopr where s.astid=:astid!
bus04_003=update tblasset set astqnt=:astqnt!,astprc=:astprc!,astnote=:astnote! where astid=:astid!
bus04_004=delete from tblasset  where astid=:astid!

#\u644a\u9500\u7ba1\u7406
bus05_000=select z.*,g.gctnm as arzgctnm from tblarz z left outer join tblgrpclient g on g.gctid=z.arzgctid where z.arzgctid=:arzgctid! and z.arzitem=:arzitem! and z.arzmonth=:arzmonth! and  z.arzdt >= :start! and z.arzdt <= :end! and z.arzisexp = :arzisexp!
bus05_001=insert into tblarz (arzid,arzgctid,arzitem,arzamount,arzmonth,arzisexp,arzcontract,arznt,arzmon,arzdt,arzopr,arzstdt,arzexpdt) values (:arzid!,:arzgctid!,:arzitem!,:harzamount!,:harzmonth!,:harzisexp!,:harzcontract!,:harznt!,:harzmon!,:arzdt!,:arzopr!,:harzstdt!,:harzexpdt!)
bus05_002=insert into tblarz (arzid,arzgctid,arzitem,arzamount,arzmonth,arzisexp,arzcontract,arznt,arzmon,arzdt,arzopr,arzstdt,arzexpdt) values (:arzid!,:arzgctid!,:arzitem!,:farzamount!,:farzmonth!,:farzisexp!,:farzcontract!,:farznt!,:farzmon!,:arzdt!,:arzopr!,:farzstdt!,:farzexpdt!)
bus05_003=insert into tblarz (arzid,arzgctid,arzitem,arzamount,arzmonth,arzisexp,arzcontract,arznt,arzmon,arzdt,arzopr,arzstdt,arzexpdt) values (:arzid!,:arzgctid!,:arzitem!,:darzamount!,:darzmonth!,:darzisexp!,:darzcontract!,:darznt!,:darzmon!,:arzdt!,:arzopr!,:darzstdt!,:darzexpdt!)
bus05_004=insert into tblarz (arzid,arzgctid,arzitem,arzamount,arzmonth,arzisexp,arzcontract,arznt,arzmon,arzdt,arzopr,arzstdt,arzexpdt) values (:arzid!,:arzgctid!,:arzitem!,:aarzamount!,:aarzmonth!,:aarzisexp!,:aarzcontract!,:aarznt!,:aarzmon!,:arzdt!,:arzopr!,:aarzstdt!,:aarzexpdt!)
bus05_005=insert into tblarz (arzid,arzgctid,arzitem,arzamount,arzmonth,arzisexp,arzcontract,arznt,arzmon,arzdt,arzopr,arzstdt,arzexpdt) values (:arzid!,:arzgctid!,:arzitem!,:tarzamount!,:tarzmonth!,:tarzisexp!,:tarzcontract!,:tarznt!,:tarzmon!,:arzdt!,:arzopr!,:tarzstdt!,:tarzexpdt!)
bus05_006=insert into tblarz (arzid,arzgctid,arzitem,arzamount,arzmonth,arzisexp,arzcontract,arznt,arzmon,arzdt,arzopr,arzstdt,arzexpdt) values (:arzid!,:arzgctid!,:arzitem!,:oarzamount!,:oarzmonth!,:oarzisexp!,:oarzcontract!,:oarznt!,:oarzmon!,:arzdt!,:arzopr!,:oarzstdt!,:oarzexpdt!)
bus05_007=select z.*,g.gctnm as arzgctnm,c.bsc012 as arzoprnm from tblarz z left outer join tblgrpclient g on g.gctid=z.arzgctid left outer join sc05 c on c.bsc011=z.arzopr where z.arzid=:arzid! 
bus05_008=update tblarz set arzisexp=:arzisexp!, arzcontract=:arzcontract! ,arznt=:arznt! where arzid=:arzid!
bus05_009=delete from tblarz where arzid=:arzid!

fee_select=select * from tblfee f  where feegctid=:feegctid! and feeyear=:feeyear! and feemonth=:feemonth!
fe2_select=select f.*, s.bsc012,g.gctnm as feegctname from tblfee f left OUTER JOIN sc05 s on f.feeop=s.bsc011 left outer join tblgrpclient g on g.gctid=f.feegctid where feegctid=:feegctid! and feeyear=:feeyear! and feemonth=:feemonth! 
#fe2_select=select b.feeyear,b.feemonth, b.feegctid,b.feesales,b.feemanage,b.feerent as bfeerent,b.feepension as bfeepension, b.feetax as bfeetax,b.feeassets as bfeeassets,b.feepay as bfeepay,b.feebuilt as bfeebuilt,b.feeopen as bfeeopen,b.feothersa as bfeothersa,b.feead as bfeead,b.feephone as bfeephone,b.feewater as bfeewater,b.feetrip as bfeetrip,b.feepostage as bfeepostage,b.feeoffice as bfeeoffice,b.feesocial as bfeesocial,b.feemedical as bfeemedical,b.feeaccount as bfeeaccount,b.feeothersb as bfeeothersb,b.feedevice as bfeedevice,b.feeinvoice as bfeeinvoice,b.feetrans as bfeetrans,b.feeprocess as bfeeprocess,b.feent as bfeent,f.feerent as ffeerent,f.feepension as ffeepension, f.feetax as ffeetax,f.feeassets as ffeeassets,f.feepay as ffeepay,f.feebuilt as ffeebuilt,f.feeopen as ffeeopen,f.feothersa as ffeothersa,f.feead as ffeead,f.feephone as ffeephone,f.feewater as ffeewater,f.feetrip as ffeetrip,f.feepostage as ffeepostage,f.feeoffice as ffeeoffice,f.feesocial as ffeesocial,f.feemedical as ffeemedical,f.feeaccount as ffeeaccount,f.feeothersb as ffeeothersb,f.feedevice as ffeedevice,f.feeinvoice as ffeeinvoice,f.feetrans as ffeetrans,f.feeprocess as ffeeprocess,f.feent as ffeent,n.feerent as nfeerent,n.feepension as nfeepension, n.feetax as nfeetax,n.feeassets as nfeeassets,n.feepay as nfeepay,n.feebuilt as nfeebuilt,n.feeopen as nfeeopen,n.feothersa as nfeothersa,n.feead as nfeead,n.feephone as nfeephone,n.feewater as nfeewater,n.feetrip as nfeetrip,n.feepostage as nfeepostage,n.feeoffice as nfeeoffice,n.feesocial as nfeesocial,n.feemedical as nfeemedical,n.feeaccount as nfeeaccount,n.feeothersb as nfeeothersb,n.feedevice as nfeedevice,n.feeinvoice as nfeeinvoice,n.feetrans as nfeetrans,n.feeprocess as nfeeprocess,n.feent as nfeent from tblfee b,tblfee f,tblfee n where b.feeyear = f.feeyear and b.feemonth = f.feemonth and b.feegctid = f.feegctid  and b.feeyear = n.feeyear and b.feemonth = n.feemonth and b.feegctid = n.feegctid and b.feetype='0' and  f.feetype='1' and n.feetype ='2' and b.feeyear=:feeyear! and b.feemonth=:feemonth! and b.feegctid=:feegctid!
#fe3_select=select distinct f.*,g.gctnm as feegctname, s.bsc012 from tblfee f left OUTER JOIN sc05 s on f.feeop=s.bsc011 left outer join tblgrpclient g on g.gctid=f.feegctid where feegctid=:feegctid! and feeyear=:feeyear! and feemonth=:feemonth! and g.gctarea=:gctarea! 
fe3_select=select f.*, round(sum( decode(amotype,'trans',meiyue,null)),2) as trans, round(sum( decode(amotype,'assetscom',meiyue,null)),2) as assetscom, round( sum( decode(amotype,'assetscon',meiyue,null)),2) as assetscon, round(sum(decode(amotype,'assetsmach',meiyue,null)),2) as assetsmach, round(sum( decode(amotype,'built',meiyue,null)),2) as built, round(sum( decode(amotype,'open',meiyue,null)),2) as open, round(sum( decode(amotype,'other',meiyue,null)),2) as other, round(sum( decode(amotype,'rent',meiyue,null)),2) as rent, max(g.gctnm) as feegctname, max(s.bsc012 ) as bsc012 from tblfee f full outer join (select t.amotype as amotype, t.feegctid as id,sum(t.money/(months_between(t.feeend,t.feestart)+1)) as meiyue from tblfeeamortize t where t.feegctid=:feegctid! and feestart<=to_date(:feeyear!||:feemonths!,'yyyy-mm') and feeend >= to_date(:feeyear!||:feemonths!,'yyyy-mm') group by t.amotype, t.feegctid) a on a.id = f.feegctid left outer join sc05 s on f.feeop =s.bsc011 left outer join tblgrpclient g on g.gctid=f.feegctid where 1=1 and f.feegctid=:feegctid! and g.gctarea=:gctarea! and f.feeyear=:feeyear! and f.feemonth=:feemonths! group by f.feeyear, f.feemonth, f.feegctid, f.feerent , f.feetax , f.feepension , f.feeassets , f.feepay , f.feebuilt , f.feeopen , f.feothersa , f.feead , f.feephone , f.feewater , f.feetrip , f.feepostage , f.feeoffice , f.feesocial , f.feemedical , f.feeaccount , f.feeop, f.feeopdata , f.feeothersb , f.feesales , f.feedevice , f.feemanage , f.feeinvoice , f.feetrans , f.feeprocess , f.feent,f.feepromotion,f.feeback
to_amotize=select * from tblfee where feeyear='-1'
amo_select=select feeamoid,feegctid,to_char(feestart,'yyyy-mm') as feestart,to_char(feeend,'yyyy-mm') as feeend,amotype,amomoney,feelong,money,note,feegctname,operdate,g.gctarea from tblfeeamortize a left outer join tblgrpclient g on a.feegctid = g.gctid where 1=1 and a.feegctid=:feegctid! and g.gctarea=:gctarea! order by g.gctarea,a.feegctid
fee_insert=insert into tblfee (feegctid,feeyear,feemonth,feerent,feetax,feepension,feeassets,feepay,feebuilt,feeopen,feothersa,feead,feewater,feetrip,feepostage,feeoffice,feesocial,feeopdata,feeaccount,feeop,feephone,feesales,feedevice,feemanage,feeinvoice,feetrans,feeprocess,feepromotion,feeback,feemedical) values (:feegctid!,:feeyear!,:feemonth!,:feerent!,:feetax!,:feepension!,:feeassets!,:feepay!,:feebuilt!,:feeopen!,:feothersa!,:feead!,:feewater!,:feetrip!,:feepostage!,:feeoffice!,:feesocial!,:feeopdata!,:feeaccount!,:feeop!,:feephone!,:feesales!,:feedevice!,:feemanage!,:feeinvoice!,:feetrans!,:feeprocess!,:feepromotion!,:feeback!,:feemedical!)

#fee_insert1=insert into tblfee (feegctid,feeyear,feemonth,feetype,feerent,feetax,feepension,feeassets,feepay,feebuilt,feeopen,feothersa,feead,feephone,feewater,feetrip,feepostage,feeoffice,feesocial,feemedical,feeaccount,feeopdata,feeop,feeothersb,feesales,feedevice,feemanage,feeinvoice,feetrans,feeprocess,feent) values (:feegctid!,:feeyear!,:feemonth!,:feetype!,:bfeerent!,:bfeetax!,:bfeepension!,:bfeeassets!,:bfeepay!,:bfeebuilt!,:bfeeopen!,:bfeothersa!,:bfeead!,:bfeephone!,:bfeewater!,:bfeetrip!,:bfeepostage!,:bfeeoffice!,:bfeesocial!,:bfeemedical!,:bfeeaccount!,:feeopdata!,:feeop!,:bfeeothersb!,:feesales!,:bfeedevice!,:feemanage!,:bfeeinvoice!,:bfeetrans!,:bfeeprocess!,:bfeent!)
#fee_insert2=insert into tblfee (feegctid,feeyear,feemonth,feetype,feerent,feetax,feepension,feeassets,feepay,feebuilt,feeopen,feothersa,feead,feephone,feewater,feetrip,feepostage,feeoffice,feesocial,feemedical,feeaccount,feeopdata,feeop,feeothersb,feesales,feedevice,feemanage,feeinvoice,feetrans,feeprocess,feent) values (:feegctid!,:feeyear!,:feemonth!,:feetype!,:ffeerent!,:ffeetax!,:ffeepension!,:ffeeassets!,:ffeepay!,:ffeebuilt!,:ffeeopen!,:ffeothersa!,:ffeead!,:ffeephone!,:ffeewater!,:ffeetrip!,:ffeepostage!,:ffeeoffice!,:ffeesocial!,:ffeemedical!,:ffeeaccount!,:feeopdata!,:feeop!,:ffeeothersb!,:feesales!,:ffeedevice!,:feemanage!,:ffeeinvoice!,:ffeetrans!,:ffeeprocess!,:ffeent!)
#fee_insert3=insert into tblfee (feegctid,feeyear,feemonth,feetype,feerent,feetax,feepension,feeassets,feepay,feebuilt,feeopen,feothersa,feead,feephone,feewater,feetrip,feepostage,feeoffice,feesocial,feemedical,feeaccount,feeopdata,feeop,feeothersb,feesales,feedevice,feemanage,feeinvoice,feetrans,feeprocess,feent) values (:feegctid!,:feeyear!,:feemonth!,:feetype!,:nfeerent!,:nfeetax!,:nfeepension!,:nfeeassets!,:nfeepay!,:nfeebuilt!,:nfeeopen!,:nfeothersa!,:nfeead!,:nfeephone!,:nfeewater!,:nfeetrip!,:nfeepostage!,:nfeeoffice!,:nfeesocial!,:nfeemedical!,:nfeeaccount!,:feeopdata!,:feeop!,:nfeeothersb!,:feesales!,:nfeedevice!,:feemanage!,:nfeeinvoice!,:nfeetrans!,:nfeeprocess!,:nfeent!)

fee_update=update tblfee set feerent=:feerent!,feetax=:feetax!,feepension=:feepension!,feeassets=:feeassets!,feepay=:feepay!,feebuilt=:feebuilt!,feeopen=:feeopen!,feothersa=:feothersa!,feead=:feead!,feewater=:feewater!,feetrip=:feetrip!,feepostage=:feepostage!,feeoffice=:feeoffice!,feesocial=:feesocial!,feeopdata=:feeopdata!,feeaccount=:feeaccount!,feeop=:feeop!,feephone=:feephone!,feesales=:feesales!,feedevice=:feedevice!,feemanage=:feemanage!,feeinvoice=:feeinvoice!,feetrans=:feetrans!,feeprocess=:feeprocess!,feepromotion=:feepromotion!,feeback=:feeback!,feemedical=:feemedical! where feegctid=:feegctid! and feeyear=:feeyear! and feemonth=:feemonth!
#fee_update1=update tblfee set feerent=:bfeerent!,feetax=:bfeetax!,feepension=:bfeepension!,feeassets=:bfeeassets!,feepay=:bfeepay!,feebuilt=:bfeebuilt!,feeopen=:bfeeopen!,feothersa=:bfeothersa!,feead=:bfeead!,feephone=:bfeephone!,feewater=:bfeewater!,feetrip=:bfeetrip!,feepostage=:bfeepostage!,feeoffice=:bfeeoffice!,feesocial=:bfeesocial!,feemedical=:bfeemedical!,feeaccount=:bfeeaccount!,feeopdata=:feeopdata!,feeop=:feeop!,feeothersb=:bfeeothersb!,feesales=:feesales!,feedevice=:bfeedevice!,feemanage=:feemanage!,feeinvoice=:bfeeinvoice!,feetrans=:bfeetrans!,feeprocess=:bfeeprocess!,feent=:bfeent! where feegctid=:feegctid! and feeyear=:feeyear! and feemonth=:feemonth! and feetype=:feetype!	
#fee_update2=update tblfee set feerent=:ffeerent!,feetax=:ffeetax!,feepension=:ffeepension!,feeassets=:ffeeassets!,feepay=:ffeepay!,feebuilt=:ffeebuilt!,feeopen=:ffeeopen!,feothersa=:ffeothersa!,feead=:ffeead!,feephone=:ffeephone!,feewater=:ffeewater!,feetrip=:ffeetrip!,feepostage=:ffeepostage!,feeoffice=:ffeeoffice!,feesocial=:ffeesocial!,feemedical=:ffeemedical!,feeaccount=:ffeeaccount!,feeopdata=:feeopdata!,feeop=:feeop!,feeothersb=:ffeeothersb!,feesales=:feesales!,feedevice=:ffeedevice!,feemanage=:feemanage!,feeinvoice=:ffeeinvoice!,feetrans=:ffeetrans!,feeprocess=:ffeeprocess!,feent=:ffeent! where feegctid=:feegctid! and feeyear=:feeyear! and feemonth=:feemonth! and feetype=:feetype!		
#fee_update3=update tblfee set feerent=:nfeerent!,feetax=:nfeetax!,feepension=:nfeepension!,feeassets=:nfeeassets!,feepay=:nfeepay!,feebuilt=:nfeebuilt!,feeopen=:nfeeopen!,feothersa=:nfeothersa!,feead=:nfeead!,feephone=:nfeephone!,feewater=:nfeewater!,feetrip=:nfeetrip!,feepostage=:nfeepostage!,feeoffice=:nfeeoffice!,feesocial=:nfeesocial!,feemedical=:nfeemedical!,feeaccount=:nfeeaccount!,feeopdata=:feeopdata!,feeop=:feeop!,feeothersb=:nfeeothersb!,feesales=:feesales!,feedevice=:nfeedevice!,feemanage=:feemanage!,feeinvoice=:nfeeinvoice!,feetrans=:nfeetrans!,feeprocess=:nfeeprocess!,feent=:nfeent! where feegctid=:feegctid! and feeyear=:feeyear! and feemonth=:feemonth! and feetype=:feetype!	

sale_select=select * from tblmonth where mgctid=:mgctid! and myear=:myear! and mmonth=:mmonth!
sale_sale=select m.*,s.bsc012 as mopnm from tblmonth m left outer join sc05 s on m.mop=s.bsc011 where mgctid=:mgctid! and myear=:myear! and mmonth=:mmonth!
sale_insert=insert into tblmonth (mgctid,myear,mmonth,mad,mback,msales,mpamnt,marrears,mothers,mnote,mnsales,mopdt,mop) values(:mgctid!,:myear!,:mmonth!,:mad!,:mback!,:msales!,:mpamnt!,:marrears!,:mothers!,:mnote!,:mnsales!,:mopdt!,:mop!)
sale_update=update tblmonth set mad=:mad!,mback=:mback!,msales=:msales!,mpamnt=:mpamnt!,marrears=:marrears!,mothers=:mothers!,mnote=:mnote!,mnsales=:mnsales!,mopdt=:mopdt!,mop=:mop! where mgctid=:mgctid! and myear=:myear! and mmonth=:mmonth!
